<div class="row text-center m-20">
  <h3>Absence Summary</h3>
  <div class="text-muted">{{date}}</div>
</div>
<app-report-filters (formAction)="onSubmit($event)"></app-report-filters>
<div class="row mt-30" *ngIf="noAbsenceMessage">
  <div class="alert-warning m-20 p-20">No Absences have been created so far.</div>
</div>
<div *ngIf="!noAbsenceMessage">
  <div class="row mt-30">
    <div class="col-md-4">
      <table>
        <tr>
          <td class="text-center">
            <h4>Total</h4>
            <canvas id="myChart" #chartTotal baseChart [legend]="false" width="150" height="100" [data]="totalAbsence" [colors]="totalChartColors" [labels]="['Total']" [chartType]="'doughnut'" [options]="chartOptions"></canvas>
            <div class="donut-inner">
              <h5>{{reportSummary.totalCount}}</h5>
            </div>
          </td>
          <td class="text-center">
            <h4>Filled</h4>
            <canvas #chartFilled baseChart [legend]="false" width="150" height="100" [data]="filledAbsence" [colors]="filledChartColors" [labels]="['Total', 'Filled']" [chartType]="'doughnut'" [options]="chartOptions"></canvas>
            <div class="donut-inner">
              <h5>{{reportSummary.filled}}</h5>
            </div>
          </td>
        </tr>
        <tr>
          <td class="text-center">
            <h4>Unfilled</h4>
            <canvas #chartUnFilled baseChart [legend]="false" width="150" height="100" [colors]="unFilledChartColors" [data]="unFilledAbsence" [labels]="['Unfilled', '']" [chartType]="'doughnut'" [options]="chartOptions"></canvas>
            <div class="donut-inner">
              <h5>{{reportSummary.unfilled}}</h5>
            </div>
          </td>
          <td class="text-center">
            <h4>No Sub Req</h4>
            <canvas #chartNoSubReq baseChart [legend]="false" width="150" height="100" [colors]="noSubReqChartColors" [data]="noSubReqAbsence" [labels]="['No Sub Req', '']" [chartType]="'doughnut'" [options]="chartOptions"></canvas>
            <div class="donut-inner">
              <h5>{{reportSummary.noSubRequired}}</h5>
            </div>
          </td>
        </tr>
      </table>
    </div>
    <div class="col-md-4">
      <canvas baseChart [chartType]="'bar'" [legend]="false" [data]="absenceSummary" [colors]="absenceSummaryColors" [labels]="['Filled', 'UnFilled', 'No Sub Required']"></canvas>
      <h4 class="report-summary-bar-chart-title">ABSENCES</h4>
    </div>
    <div class="col-md-4">
      <canvas baseChart [chartType]="'doughnut'" [legend]="true" width="150" height="100" [data]="absenceSummary" [colors]="absenceSummaryColors" [labels]="['Filled', 'UnFilled', 'No Sub Required']" [options]="chartOptions"></canvas>
    </div>
  </div>
  <div class="row">
    <mat-tab-group>
      <mat-tab label="Filled">
        <div class="m-30">
          <ngx-datatable class="material" [rows]="filledAbsenceDetails" [columnMode]="'flex'" [headerHeight]="50" [footerHeight]="50" [rowHeight]="'auto'" [limit]="10">
            <ngx-datatable-column name="Employee" prop="employeeName" [flexGrow]="2" cellClass="middle" [draggable]="false">
              <ng-template let-rowIndex="rowIndex" let-value="value" let-row="row" ngx-datatable-cell-template>
                <div class="ellipsis" [title]="value">
                  <strong>{{row['employeeName']}}</strong><br>
                  <span>{{ row['employeeTypeTitle']}}. {{ row['subject'] }}. {{row['grade']}}</span><br>
                  <span>{{ row['districtName'] }}</span><br>
                </div>
              </ng-template>
            </ngx-datatable-column>
            <ngx-datatable-column name="Date" [flexGrow]="2" cellClass="middle" [draggable]="false">
              <ng-template let-rowIndex="rowIndex" let-value="value" let-row="row" ngx-datatable-cell-template>
                <div class="ellipsis">{{ row['startDate'] | date:'E, M/d/y' }}</div>
                <div class="ellipsis">{{ row['endDate'] | date:'E, M/d/y' }}</div>
              </ng-template>
            </ngx-datatable-column>
            <ngx-datatable-column name="Status" [flexGrow]="2" cellClass="middle" [draggable]="false">
              <ng-template let-rowIndex="rowIndex" let-value="value" let-row="row" ngx-datatable-cell-template>
                <div class="ellipsis">{{ row['statusTitle'] }}</div>
              </ng-template>
            </ngx-datatable-column>
            <ngx-datatable-column name="Substitute" [flexGrow]="2" cellClass="middle" [draggable]="false">
              <ng-template let-rowIndex="rowIndex" let-value="value" let-row="row" ngx-datatable-cell-template>
                <div class="row">
                  <div class="col-md-1 photo">
                    <!-- <img [src]="getImage(row['substituteProfilePicUrl'])" /> -->
                    <mat-icon>person</mat-icon>
                  </div>
                  <div class="col-md-8">
                    <div class="ellipsis">
                      {{ row['substituteName']}}
                    </div>
                  </div>
                </div>
              </ng-template>
            </ngx-datatable-column>
            <ngx-datatable-column name="Actions" [width]="150" [sortable]="false" [draggable]="false" [canAutoResize]="false">
              <ng-template let-rowIndex="rowIndex" let-id="value" let-row="row" ngx-datatable-cell-template>
                <button type="button" mat-icon-button color="primary" [disableRipple]="true" (click)="reportDetails(row)">
                  <mat-icon>format_list_bulleted</mat-icon>
                </button>
              </ng-template>
            </ngx-datatable-column>
          </ngx-datatable>
        </div>
      </mat-tab>
      <mat-tab label="UnFilled">
        <div class="m-30">
          <ngx-datatable class="material" [rows]="unFilledAbsenceDetails" [columnMode]="'flex'" [headerHeight]="50" [footerHeight]="50" [rowHeight]="'auto'" [limit]="10">
            <ngx-datatable-column name="Employee" prop="employeeName" [flexGrow]="2" cellClass="middle" [draggable]="false">
              <ng-template let-rowIndex="rowIndex" let-value="value" let-row="row" ngx-datatable-cell-template>
                <div class="ellipsis" [title]="value">
                  <strong>{{row['employeeName']}}</strong><br>
                  <span>{{ row['employeeTypeTitle']}}. {{ row['subject'] }}. {{row['grade']}}</span><br>
                  <span>{{ row['districtName'] }}</span><br>
                </div>
              </ng-template>
            </ngx-datatable-column>
            <ngx-datatable-column name="Date" [flexGrow]="2" cellClass="middle" [draggable]="false">
              <ng-template let-rowIndex="rowIndex" let-value="value" let-row="row" ngx-datatable-cell-template>
                <div class="ellipsis">{{ row['startDate'] | date:'E, M/d/y' }}</div>
                <div class="ellipsis">{{ row['endDate'] | date:'E, M/d/y' }}</div>
              </ng-template>
            </ngx-datatable-column>
            <ngx-datatable-column name="Status" [flexGrow]="2" cellClass="middle" [draggable]="false">
              <ng-template let-rowIndex="rowIndex" let-value="value" let-row="row" ngx-datatable-cell-template>
                <div class="ellipsis">{{ row['statusTitle'] }}</div>
              </ng-template>
            </ngx-datatable-column>
            <ngx-datatable-column name="Substitute" [flexGrow]="2" cellClass="middle" [draggable]="false">
              <ng-template let-rowIndex="rowIndex" let-value="value" let-row="row" ngx-datatable-cell-template>
                N/A
              </ng-template>
            </ngx-datatable-column>
            <ngx-datatable-column name="Actions" [width]="150" [sortable]="false" [draggable]="false" [canAutoResize]="false">
              <ng-template let-rowIndex="rowIndex" let-id="value" let-row="row" ngx-datatable-cell-template>
                <button type="button" mat-icon-button color="primary" [disableRipple]="true" (click)="reportDetails(row)">
                  <mat-icon>format_list_bulleted</mat-icon>
                </button>
              </ng-template>
            </ngx-datatable-column>
          </ngx-datatable>
        </div>
      </mat-tab>
      <mat-tab label="No Sub Req">
        <div class="m-30">
          <ngx-datatable class="material" [rows]="noSubReqAbsenceDetails" [columnMode]="'flex'" [headerHeight]="50" [footerHeight]="50" [rowHeight]="'auto'" [limit]="10">
            <ngx-datatable-column name="Employee" prop="employeeName" [flexGrow]="2" cellClass="middle" [draggable]="false">
              <ng-template let-rowIndex="rowIndex" let-value="value" let-row="row" ngx-datatable-cell-template>
                <div class="ellipsis" [title]="value">
                  <strong>{{row['employeeName']}}</strong><br>
                  <span>{{ row['employeeTypeTitle']}}. {{ row['subject'] }}. {{row['grade']}}</span><br>
                  <span>{{ row['districtName'] }}</span><br>
                </div>
              </ng-template>
            </ngx-datatable-column>
            <ngx-datatable-column name="Date" [flexGrow]="2" cellClass="middle" [draggable]="false">
              <ng-template let-rowIndex="rowIndex" let-value="value" let-row="row" ngx-datatable-cell-template>
                <div class="ellipsis">{{ row['startDate'] | date:'E, M/d/y' }}</div>
                <div class="ellipsis">{{ row['endDate'] | date:'E, M/d/y' }}</div>
              </ng-template>
            </ngx-datatable-column>
            <ngx-datatable-column name="Status" [flexGrow]="2" cellClass="middle" [draggable]="false">
              <ng-template let-rowIndex="rowIndex" let-value="value" let-row="row" ngx-datatable-cell-template>
                N/A
              </ng-template>
            </ngx-datatable-column>
            <ngx-datatable-column name="Substitute" [flexGrow]="2" cellClass="middle" [draggable]="false">
              <ng-template let-rowIndex="rowIndex" let-value="value" let-row="row" ngx-datatable-cell-template>
                No Sub Required
              </ng-template>
            </ngx-datatable-column>
            <ngx-datatable-column name="Actions" [width]="150" [sortable]="false" [draggable]="false" [canAutoResize]="false">
              <ng-template let-rowIndex="rowIndex" let-id="value" let-row="row" ngx-datatable-cell-template>
                <button type="button" mat-icon-button color="primary" [disableRipple]="true" (click)="reportDetails(row)">
                  <mat-icon>format_list_bulleted</mat-icon>
                </button>
              </ng-template>
            </ngx-datatable-column>
          </ngx-datatable>
        </div>
      </mat-tab>
    </mat-tab-group>
  </div>
</div>