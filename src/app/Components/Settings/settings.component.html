<div class="main-container">
    <Subzz-app-SideNav></Subzz-app-SideNav>
    <div class="row">
        <div class="col-md-10 col-md-offset-1">
            <div class="row">
                <mat-card>
                    <mat-card-title>
                        My Settings
                    </mat-card-title>
                    <mat-card-content>
                        <mat-tab-group class="demo-tab-group" (selectedTabChange)="onChangeTab($event)">
                            <mat-tab *ngIf='UserRole != 4' label="Substitute Preferences">
                                <form (ngSubmit)="SaveSubstitutePreference()" [formGroup]="PreferencesFormGroup">
                                    <div style="padding-top: 10px; min-height:500px" class=" col-md-10 col-md-offset-1 shadow">
                                        <div style="font-size: 15px" class="col-md-12">
                                            <div class="row">
                                                <div class="col-md-5">
                                                    <b> Favorite Substitutes </b>
                                                    <br> Remaining choices: {{5 - FavoriteSubstututes.length}}
                                                </div>
                                                <div class="col-md-7">
                                                    <mat-form-field class="col-md-5 col-lg-5">
                                                        <input type="text" placeholder="Search Substitute here" aria-label="Number" (input)="SearchSubstitutes($event.target.value)"
                                                            matInput [matAutocomplete]="autoCom">
                                                        <mat-autocomplete #autoCom="matAutocomplete">
                                                            <mat-option (onSelectionChange)="SelectToAddInPreferredSubstitute(user)" *ngFor="let user of SubstituteList | async" [value]="">
                                                                {{user.firstName}}
                                                            </mat-option>
                                                        </mat-autocomplete>
                                                    </mat-form-field>
                                                </div>
                                            </div>
                                        </div>
                                        <hr>
                                        <div style="height:175px" class="col-md-12">
                                            <div *ngIf='FavoriteSubstututes && FavoriteSubstututes.length'>
                                                <a *ngFor="let Substitute of FavoriteSubstututes">
                                                    <mat-icon style="cursor: pointer;" #tooltip="matTooltip" (click)="FavoriteSubstututes.splice($index,1)" matTooltip="Remove Substitute"
                                                        matTooltipPosition="left">cancel</mat-icon>{{Substitute.firstName}}
                                                    <br>
                                                </a>
                                            </div>
                                        </div>
                                        <div style="font-size: 15px" class="col-md-12">
                                            <div class="row">
                                                <div class="col-md-5">
                                                    <b> Blocked Substitutes </b>
                                                    <br> Remaining choices: {{5 - BlockedSubstitutes.length}}
                                                </div>
                                                <div class="col-md-7">
                                                    <mat-form-field class="col-md-10 col-lg-10">
                                                        <input type="text" placeholder="Search Substitute here" aria-label="Number" (input)="SearchSubstitutes($event.target.value)"
                                                            matInput [matAutocomplete]="auto">
                                                        <mat-autocomplete #auto="matAutocomplete">
                                                            <mat-option (onSelectionChange)="SelectToBlockSubstitite(user)" *ngFor="let user of SubstituteList | async" [value]="">
                                                                {{user.firstName}}
                                                            </mat-option>
                                                        </mat-autocomplete>
                                                    </mat-form-field>
                                                </div>
                                            </div>
                                        </div>
                                        <hr>
                                        <div style="height:175px;" class="col-md-12">
                                            <div *ngIf='BlockedSubstitutes && BlockedSubstitutes.length'>
                                                <a *ngFor="let Substitute of BlockedSubstitutes">
                                                    <mat-icon style="cursor: pointer;" #tooltip="matTooltip" (click)="BlockedSubstitutes.splice($index,1)" matTooltip="Remove Substitute"
                                                        matTooltipPosition="left">cancel</mat-icon>{{Substitute.firstName}}
                                                    <br>
                                                </a>

                                            </div>
                                        </div>
                                        <div style="text-align: center" class="col-md-12">
                                            <button mat-raised-button style="color:white; background-color: #04c0be;" type="submit">Save</button>
                                        </div>
                                    </div>
                                </form>
                            </mat-tab>
                            <!-- <mat-tab *ngIf='!isSubstitute' label="Organization Settings">
        
        </mat-tab> -->
                            <mat-tab *ngIf='!isSubstitute && UserRole != 3' label="Lists">
                                <div style="padding-top:10px ">
                                    <div class="row col-md-12">
                                        <div class="col-md-6" style="text-align:right">
                                            <mat-form-field *ngIf='showDetail'>
                                                <input matInput type="text" placeholder="List Name">
                                            </mat-form-field>
                                        </div>
                                        <div class="col-md-6" style="text-align:right">
                                            <button mat-raised-button class="btn btn-success" style="background: #3CCCD1;color: white" type="button" (click)="showDetail = !showDetail">Create List</button>
                                        </div>
                                    </div>
                                    <div *ngIf='showDetail' class="row col-md-12">
                                        <div class="row" *ngFor="let sub of substituteList">
                                            <mat-form-field class="col-md-3">
                                                <input matInput type="text" [(ngModel)]="sub.firstName" placeholder="first name">
                                            </mat-form-field>
                                            <mat-form-field class="col-md-3">
                                                <input matInput disabled type="text" [(ngModel)]="sub.lastName" placeholder="last name">
                                            </mat-form-field>
                                            <mat-form-field class="col-md-3">
                                                <input matInput disabled type="text" [(ngModel)]="sub.phoneNumber" placeholder="phone">
                                            </mat-form-field>
                                            <mat-form-field class="col-md-3">
                                                <input matInput type="text" [(ngModel)]="sub.tag" placeholder="tags">
                                            </mat-form-field>
                                        </div>
                                    </div>
                                    <div *ngIf='showDetail' style="text-align: right" class="row col-md-12">
                                        <button mat-raised-button class="btn btn-success" style="background: #3CCCD1;color: white" type="button" (click)="saveSubstituteList(substituteList)">Save</button>
                                    </div>
                                </div>
                            </mat-tab>
                            <mat-tab *ngIf='!isSubstitute && UserRole != 3' label="Payroll Settings">
                                <div class="row col-md-8 col-md-offset-2">
                                    <div class="row">
                                        <div class="col-md-12" style="margin-top:10px;text-align: center">
                                            <b>
                                                These subs will have
                                                <mat-form-field style="width:75px">
                                                    <mat-select [(value)]="TimeCustomDelay" placeholder="hours">
                                                        <mat-option value="1">12 hours</mat-option>
                                                        <mat-option value="2">6 hours</mat-option>
                                                        <mat-option value="3">2 hours</mat-option>
                                                    </mat-select>
                                                </mat-form-field>
                                                to accept the request before we notify the rest of your sub.
                                            </b>
                                        </div>
                                        <div class="col-md-12">
                                            <table mat-table [dataSource]="dataSource" class="mat-elevation-z8">

                                                <ng-container matColumnDef="event">
                                                    <th mat-header-cell *matHeaderCellDef> Event </th>
                                                    <td mat-cell *matCellDef="let row"> {{row.Event}} </td>
                                                </ng-container>

                                                <!-- Weight Column -->
                                                <ng-container matColumnDef="email">
                                                    <th mat-header-cell *matHeaderCellDef>
                                                        <span class="HeaderAlignment">
                                                            <i class="material-icons">
                                                                email
                                                            </i>
                                                            <span style="padding-top:5px ">Email Alert</span>
                                                        </span>
                                                    </th>
                                                    <td mat-cell *matCellDef="let row ;let i = index;">
                                                        <mat-checkbox color="primary" (click)="$event.stopPropagation()" (change)="$event ? ChangeNotificationPreference(row, 'Email') : null"
                                                            [checked]="row.Email">
                                                        </mat-checkbox>
                                                        {{row.Email}}
                                                    </td>
                                                </ng-container>
                                                <ng-container matColumnDef="text">
                                                    <th mat-header-cell *matHeaderCellDef>
                                                        <span class="HeaderAlignment">
                                                            <i class="material-icons">
                                                                message
                                                            </i>
                                                            <span style="padding-top:5px ">Text Message Alert</span>
                                                        </span>
                                                    </th>
                                                    <td mat-cell *matCellDef="let row">
                                                        <mat-checkbox color="primary" (click)="$event.stopPropagation()" (change)="$event ? ChangeNotificationPreference(row, 'Text') : null"
                                                            [checked]="row.Text">
                                                        </mat-checkbox>
                                                    </td>
                                                </ng-container>

                                                <ng-container matColumnDef="voice">
                                                    <th mat-header-cell *matHeaderCellDef>
                                                        <span class="HeaderAlignment">
                                                            <i class="material-icons">
                                                                record_voice_over
                                                            </i>
                                                            <span style="padding-top:5px ">Voice Alert</span>
                                                        </span>
                                                    </th>
                                                    <td mat-cell *matCellDef="let row">
                                                        <mat-checkbox color="primary" (click)="$event.stopPropagation()" (change)="$event ? ChangeNotificationPreference(row,'voice') : null"
                                                            [checked]="row.voice">
                                                        </mat-checkbox>
                                                    </td>
                                                </ng-container>
                                                <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                                                <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
                                            </table>

                                        </div>
                                    </div>
                                    <div class="row" style="padding-top: 20px">
                                        <div class="col-md-12" style="text-align: center">
                                            <button color="primary" mat-raised-button (click)="SaveCustomSettings()">Save</button>
                                        </div>
                                    </div>
                                </div>
                            </mat-tab>
                            <mat-tab *ngIf='!isSubstitute && UserRole != 3' label="Calendar Settings">

                            </mat-tab>
                            <mat-tab *ngIf='isSubstitute' label="Categories Settings">
                                <div class="row col-md-8 col-md-offset-2">
                                    <div class="col-md-12" style="margin-top: 6px;height: 26px;background-color: rgba(209,196,233,.3);">
                                        <p>
                                            <b> Select Categories against which you want to get notifications.</b>
                                        </p>
                                    </div>
                                    <div class="col-md-12" style="overflow-y: scroll; height:400px;">
                                        <mat-selection-list #Category>
                                            <mat-list-option *ngFor="let category of Categories" [value]="category.id" [selected]="category.isNotificationSend">
                                                {{category.title}}
                                            </mat-list-option>
                                        </mat-selection-list>
                                    </div>
                                    <div class="col-md-12" style="text-align: center">
                                        <button color="primary" mat-raised-button (click)="SaveCategories(Category)">Save</button>
                                    </div>
                                </div>
                            </mat-tab>
                            <mat-tab *ngIf='isSubstitute' label="School Settings">
                                <div class="row col-md-8 col-md-offset-2">
                                    <div class="col-md-12" style="margin-top: 6px;height: 26px;background-color: rgba(209,196,233,.3);">
                                        <p>
                                            <b> Select Schools against which you want to get notifications.</b>
                                        </p>
                                    </div>
                                    <div class="col-md-12" style="overflow-y: scroll; height:400px;">
                                        <mat-selection-list #EnabledSchools>
                                            <mat-list-option *ngFor="let school of PreferredSchools" [value]="school.organizationId" [selected]="school.isEnabled">
                                                {{school.organizationName}}
                                            </mat-list-option>
                                        </mat-selection-list>
                                    </div>
                                    <div class="col-md-12" style="text-align: center">
                                        <button color="primary" mat-raised-button (click)="SavePreferredSchoolSettings(EnabledSchools)">Save</button>
                                    </div>
                                </div>
                            </mat-tab>
                            <mat-tab *ngIf='!isSubstitute && UserRole != 3' label="General">
                                <div class="row col-md-12">
                                    School Times
                                    <br>
                                    <mat-form-field class="col-md-2">
                                        <input matInput type="text" placeholder="Start Time">
                                    </mat-form-field>
                                    <mat-form-field class="col-md-2">
                                        <input matInput type="text" placeholder="End Time">
                                    </mat-form-field>
                                    <mat-form-field class="col-md-2">
                                        <input matInput type="text" placeholder="First Half End Time">
                                    </mat-form-field>
                                    <mat-form-field class="col-md-2">
                                        <input matInput type="text" placeholder="Second Half Start Time">
                                    </mat-form-field>
                                </div>

                                <div class="row col-md-12">
                                    Job Release
                                    <br> Subs can release jobs
                                    <mat-form-field style="width:75px">
                                        <mat-select placeholder="Time">
                                            <mat-option value="1">12 hours</mat-option>
                                            <mat-option value="2">6 hours</mat-option>
                                            <mat-option value="3">2 hours</mat-option>
                                        </mat-select>
                                    </mat-form-field>
                                    to accept the request before we notify the rest of your sub.
                                </div>
                                <div class="col-md-12">
                                    Preferred subs will have
                                    <mat-form-field style="width:75px">
                                        <mat-select placeholder="Time">
                                            <mat-option value="1">12 hours</mat-option>
                                            <mat-option value="2">6 hours</mat-option>
                                            <mat-option value="3">2 hours</mat-option>
                                        </mat-select>
                                    </mat-form-field>
                                    to accept the request before we notify the rest of your sub.
                                </div>
                            </mat-tab>
                        </mat-tab-group>
                    </mat-card-content>
                </mat-card>
            </div>
        </div>
    </div>
</div>